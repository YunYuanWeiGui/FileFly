<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FileFly - 局域网文件管理器</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 自定义样式 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-mobile.css') }}">
</head>
<body>
    <!-- 主题切换动画容器 -->
    <div class="theme-transition-container" id="themeTransition"></div>

    <!-- 固定导航栏 -->
    <nav class="navbar fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-paper-plane me-2"></i>
                <span class="brand-text">FileFly</span>
            </a>
            <div class="nav-controls">
                <!-- 圆形主题切换按钮 -->
                <button id="themeToggle" class="btn btn-theme-circle" title="切换主题" aria-label="切换主题">
                    <i class="fas fa-moon"></i>
                    <span class="theme-badge"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- 主内容区域（添加导航栏占位高度） -->
    <main class="container py-4 main-content" style="margin-top: 70px;">
        <!-- 面包屑导航（由JavaScript动态渲染） -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb" id="breadcrumbContainer">
                <!-- 由JavaScript动态生成 -->
            </ol>
        </nav>

        <!-- 工具栏 -->
        <div class="card mb-4 glass-card">
            <div class="card-body py-2">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex gap-2 toolbar-buttons">
                        <button class="btn btn-primary btn-animated" id="uploadBtn" aria-label="上传文件">
                            <i class="fas fa-cloud-upload-alt me-1"></i>上传文件
                        </button>
                        <button class="btn btn-primary btn-animated" id="createFolderBtn" aria-label="新建文件夹">
                            <i class="fas fa-folder me-1"></i>新建文件夹
                        </button>
                    </div>
                    <div class="d-flex gap-2">
                        <div class="input-group input-group-sm search-container">
                            <span class="input-group-text" aria-label="搜索"><i class="fas fa-search"></i></span>
                            <input type="text" class="form-control search-input" id="searchFiles" placeholder="搜索文件..." aria-label="搜索文件">
                        </div>
                        <button class="btn btn-outline-secondary btn-animated" id="refreshBtn" aria-label="刷新">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 文件管理区域 -->
        <div class="card glass-card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-folder-open me-2"></i>
                    文件列表
                    <span class="badge bg-gradient ms-2" id="fileCount">0 个项目</span>
                </h5>
            </div>

            <!-- 文件列表 -->
            <div class="card-body p-0">
                <div class="files-container">
                    <!-- 文件网格视图 -->
                    <div class="file-grid" id="fileGrid">
                        <!-- 通过JavaScript动态生成 -->
                    </div>

                    <!-- 空状态 -->
                    <div id="emptyState" class="text-center py-5">
                        <div class="empty-animation mb-3">
                            <i class="fas fa-inbox fa-3x text-muted"></i>
                            <div class="spinner-border spinner-border-sm text-primary spinner-glow ms-2" role="status"></div>
                        </div>
                        <h5 class="empty-title">此文件夹为空</h5>
                        <p class="empty-subtitle">上传文件或创建文件夹开始使用</p>
                        <button class="btn btn-primary btn-animated mt-2" id="emptyUploadBtn" aria-label="上传文件">
                            <i class="fas fa-cloud-upload-alt me-1"></i>上传文件
                        </button>
                    </div>

                    <!-- 加载状态 -->
                    <div id="loadingState" class="text-center py-5">
                        <div class="spinner-border spinner-border-sm text-primary spinner-glow me-2" role="status">
                            <span class="visually-hidden">加载中...</span>
                        </div>
                        <span class="loading-text">加载中...</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 上传弹窗 -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content glass-card">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-cloud-upload-alt me-2"></i>
                        上传文件
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="关闭" data-bs-focus="false"></button>
                </div>
                <div class="modal-body">
                    <div class="drop-area" id="uploadArea" role="button" tabindex="0" aria-label="拖放文件或文件夹到此处或点击选择">
                        <i class="fas fa-cloud-upload-alt fa-4x mb-3 text-primary upload-icon"></i>
                        <h5>拖放文件或文件夹到此处</h5>
                        <p class="text-muted mb-3">或点击选择</p>
                        <input type="file" id="fileInput" multiple style="display: none;" aria-label="选择文件">
                        <div class="d-flex gap-2 justify-content-center">
                            <button class="btn btn-primary btn-animated" id="selectFilesBtn" aria-label="选择文件">
                                <i class="fas fa-file me-1"></i>选择文件
                            </button>
                            <button class="btn btn-outline-primary btn-animated" id="selectFolderBtn" aria-label="选择文件夹">
                                <i class="fas fa-folder me-1"></i>选择文件夹
                            </button>
                        </div>
                    </div>

                    <!-- 上传队列 -->
                    <div class="upload-queue mt-4" id="uploadQueue" style="display: none;">
                        <h6 class="mb-3">上传队列</h6>
                        <div class="queue-list" id="queueList"></div>

                        <!-- 控制按钮 -->
                        <div class="upload-controls mt-3">
                            <div class="d-flex gap-2 justify-content-center">
                                <button class="btn btn-outline-warning btn-animated" id="pauseUploadBtn" disabled aria-label="暂停上传">
                                    <i class="fas fa-pause me-1"></i>暂停
                                </button>
                                <button class="btn btn-outline-danger btn-animated" id="cancelUploadBtn" disabled aria-label="取消上传">
                                    <i class="fas fa-times me-1"></i>取消
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-animated" data-bs-dismiss="modal" aria-label="关闭">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- 拆分的JS文件 -->
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <script src="{{ url_for('static', filename='js/upload.js') }}"></script>
    <script src="{{ url_for('static', filename='js/fileManager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>